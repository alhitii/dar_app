# ๐ ูุธุงู ุงูุฅุดุนุงุฑุงุช ุงููุงูู - ูุน ุงูุตูุช

## โ **ุฌููุน ุฃููุงุน ุงูุฅุดุนุงุฑุงุช ุฌุงูุฒุฉ!**

### **1๏ธโฃ ุฅุดุนุงุฑุงุช ุงููุงุฌุจุงุช (Homeworks):**
```
Trigger: ุนูุฏ ุฅุถุงูุฉ ูุงุฌุจ ูู homeworks collection
Target: ุงูุทูุงุจ ูู ููุณ ุงูุตู ูุงูุดุนุจุฉ
Cloud Function: notifyStudentsOnHomework
```

**ุงูุฑุณุงูุฉ:**
```
๐ ูุงุฌุจ ุฌุฏูุฏ ูู ูุงุฏุฉ [ุงุณู ุงููุงุฏุฉ]
[ุนููุงู ุงููุงุฌุจ]
```

**ุงูููุฒุงุช:**
- โ ุตูุช ุงูุชุฑุงุถู
- โ ุงูุชุฒุงุฒ
- โ priority: high
- โ channel: high_importance_channel

---

### **2๏ธโฃ ุฅุดุนุงุฑุงุช ุงูุฅุฏุงุฑุฉ (Announcements):**
```
Trigger: ุนูุฏ ูุดุฑ ุฅุนูุงู ูู announcements collection
Target: ุญุณุจ ุงููุฆุฉ ุงููุฎุชุงุฑุฉ (ุทูุงุจ/ูุนูููู/ุงูุฌููุน)
Cloud Function: notifyOnAnnouncement
```

**ุงูุฑุณุงูุฉ:**
```
[emoji] [ุงูุนููุงู]
[ุงููุต]

Emoji ุญุณุจ ุงูููุน:
- info โ โน๏ธ
- success โ โ
- warning โ โ๏ธ
- error โ โ
- default โ ๐ข
```

**ุงูููุฒุงุช:**
- โ ุตูุช ุงูุชุฑุงุถู
- โ ุงูุชุฒุงุฒ
- โ priority: high
- โ channel: high_importance_channel
- โ emoji ุชููุงุฆู ุญุณุจ ุงูููุน

---

### **3๏ธโฃ ุฅุดุนุงุฑุงุช ุงูุบูุงุจ (Absences):**
```
Trigger: ุนูุฏ ุชุณุฌูู ุบูุงุจ ูู absences collection
Target: ุงูุทุงูุจ ุงูุบุงุฆุจ ููุท
Cloud Function: notifyOnAbsence
```

**ุงูุฑุณุงูุฉ:**
```
โ๏ธ ุชูุจูู ุบูุงุจ - [ุงูุชุงุฑูุฎ]
[ุฑุณุงูุฉ ุงูุบูุงุจ]
```

**ุงูููุฒุงุช:**
- โ ุตูุช ุงูุชุฑุงุถู
- โ ุงูุชุฒุงุฒ
- โ priority: high
- โ channel: high_importance_channel
- โ ูุตู ููุทุงูุจ ูุจุงุดุฑุฉ

---

## ๐ **ููุฎุต Cloud Functions:**

| Function | Trigger | Target | Status |
|----------|---------|--------|--------|
| `notifyStudentsOnHomework` | ุฅุถุงูุฉ ูุงุฌุจ | ุทูุงุจ ุงูุตู | โ deployed |
| `notifyOnAnnouncement` | ูุดุฑ ุฅุนูุงู | ุญุณุจ ุงููุฆุฉ | โ deployed |
| `notifyOnAbsence` | ุชุณุฌูู ุบูุงุจ | ุงูุทุงูุจ | โ deployed |

---

## ๐งช **ููููุฉ ุงูุงุฎุชุจุงุฑ:**

### **1๏ธโฃ ุงุฎุชุจุงุฑ ุฅุดุนุงุฑ ูุงุฌุจ:**
```
1. ุณุฌูู ุฏุฎูู ูู ุทุงูุจ (ูุญูุธ FCM Token)
2. ุฃุบูู ุงูุชุทุจูู
3. ุณุฌูู ุฏุฎูู ูู ูุนูู
4. ุฃุถู ูุงุฌุจ ุฌุฏูุฏ
5. ุงูุทุงูุจ ุณูุณุชูุจู:
   ๐ ุตูุช
   ๐ณ ุงูุชุฒุงุฒ
   ๐ฑ "๐ ูุงุฌุจ ุฌุฏูุฏ ูู ูุงุฏุฉ ..."
```

---

### **2๏ธโฃ ุงุฎุชุจุงุฑ ุฅุดุนุงุฑ ุฅุฏุงุฑู:**
```
1. ุณุฌูู ุฏุฎูู ูู ุทุงูุจ (ูุญูุธ FCM Token)
2. ุฃุบูู ุงูุชุทุจูู
3. ุณุฌูู ุฏุฎูู ูู ุฅุฏุงุฑู
4. ุงุฐูุจ ูู "ุชูุจูู ุนุงู"
5. ุงููุฃ ุงููููุฐุฌ:
   - ุงูุนููุงู: ุฅุนูุงู ููู
   - ุงููุต: ุงุฌุชูุงุน ุบุฏุงู
   - ุงููุฆุฉ: ููุทูุงุจ
   - ุงูููุน: ูุนูููุงุช
6. ุงุถุบุท "ูุดุฑ ุงูุชูุจูู"
7. ุงูุทุงูุจ ุณูุณุชูุจู:
   ๐ ุตูุช
   ๐ณ ุงูุชุฒุงุฒ
   ๐ฑ "โน๏ธ ุฅุนูุงู ููู: ุงุฌุชูุงุน ุบุฏุงู"
```

---

### **3๏ธโฃ ุงุฎุชุจุงุฑ ุฅุดุนุงุฑ ุบูุงุจ:**
```
1. ุณุฌูู ุฏุฎูู ูู ุทุงูุจ (ูุญูุธ FCM Token)
2. ุฃุบูู ุงูุชุทุจูู
3. ุณุฌูู ุฏุฎูู ูู ุฅุฏุงุฑู
4. ุงูุชุญ ุตูุญุฉ ุทุงูุจ
5. ุงุถุบุท "ุฅุฑุณุงู ุฅุดุนุงุฑ ุบูุงุจ"
6. ุงูุชุจ ุงูุฑุณุงูุฉ: "ุชู ุชุณุฌูู ุบูุงุจู ุงูููู"
7. ุงุถุบุท ุฅุฑุณุงู
8. ุงูุทุงูุจ ุณูุณุชูุจู:
   ๐ ุตูุช
   ๐ณ ุงูุชุฒุงุฒ
   ๐ฑ "โ๏ธ ุชูุจูู ุบูุงุจ - [ุงูุชุงุฑูุฎ]: ุชู ุชุณุฌูู ุบูุงุจู ุงูููู"
```

---

## ๐ง **ุงูุชูุงุตูู ุงูุชูููุฉ:**

### **Payload Structure:**
```javascript
{
  notification: {
    title: "ุงูุนููุงู",
    body: "ุงููุต",
  },
  android: {
    priority: "high",
    notification: {
      sound: "default",        // โ ุตูุช
      channelId: "high_importance_channel",
      priority: "high",
    },
  },
  apns: {
    payload: {
      aps: {
        sound: "default",      // โ ุตูุช iOS
        badge: 1,
      },
    },
  },
  token: "FCM_TOKEN" // ุฃู tokens: ["token1", "token2"]
}
```

---

## ๐ฑ **ูุชุทูุจุงุช ุงูุชุทุจูู:**

### **1. FCM Token ููุญูุธ ุนูุฏ ุชุณุฌูู ุงูุฏุฎูู:**
```dart
// ูู auth_service.dart
fcmToken = await FirebaseMessaging.instance.getToken();
await docRef.set({
  ...
  if (fcmToken != null) 'fcmToken': fcmToken,
});
```

### **2. Notification Service ููููุฃ:**
```dart
// ูู notification_service.dart
- requestPermission(sound: true)
- setForegroundNotificationPresentationOptions(sound: true)
- AndroidNotificationChannel(playSound: true)
```

### **3. AndroidManifest.xml:**
```xml
- VIBRATE permission
- WAKE_LOCK permission
- RECEIVE_BOOT_COMPLETED permission
- FCM Default Channel
- FCM Default Icon
- FCM Service
```

---

## ๐ฏ **ูุตุงุฆุญ:**

### **1. ููุชุฃูุฏ ูู ูุตูู ุงูุฅุดุนุงุฑ:**
```
- ุชุฃูุฏ ุฃู ุงูุทุงูุจ ุณุฌูู ุฏุฎูู ูุฑุฉ ูุงุญุฏุฉ (ูุญูุธ FCM Token)
- ุชุฃูุฏ ุฃู FCM Token ููุฌูุฏ ูู users collection
- ุชุฃูุฏ ุฃู ุงูุทุงูุจ ุฃุบูู ุงูุชุทุจูู ุชูุงูุงู
- ุชุฃูุฏ ูู ุฅุนุฏุงุฏุงุช ุงููุงุชู (ุตูุชุ battery optimization)
```

### **2. ููุชุฃูุฏ ูู ุงูุตูุช:**
```
- ุชุฃูุฏ ุฃู sound: "default" ููุฌูุฏ ูู payload
- ุชุฃูุฏ ุฃู channelId: "high_importance_channel"
- ุชุฃูุฏ ุฃู ุงููุงุชู ููุณ ูู Silent mode
- ุชุฃูุฏ ุฃู Battery Optimization ูุนุทูู
```

### **3. ุงุณุชูุดุงู ุงูุฃุฎุทุงุก:**
```
- ุงูุญุต Cloud Functions logs ูู Firebase Console
- ุงูุญุต Terminal logs ูู Flutter
- ุงูุญุต Firebase Console โ Cloud Messaging โ Reports
```

---

## ๐ **ุงูุญุงูุงุช ุงููุฎุชููุฉ:**

| ุงูุญุงูุฉ | ุงูุตูุช | ุงูุงูุชุฒุงุฒ | ุงูุธููุฑ |
|--------|-------|----------|--------|
| ุงูุชุทุจูู ููุชูุญ | โ | โ | โ Foreground notification |
| ูู ุงูุฎูููุฉ | โ | โ | โ ูู ุดุฑูุท ุงูุฅุดุนุงุฑุงุช |
| ูุบูู ุชูุงูุงู | โ | โ | โ ูู ุดุฑูุท ุงูุฅุดุนุงุฑุงุช |

---

## ๐ **ุงูุฎูุงุตุฉ:**

```
โ 3 ุฃููุงุน ูู ุงูุฅุดุนุงุฑุงุช ุฌุงูุฒุฉ
โ ูููุง ูุน ุตูุช ูุงูุชุฒุงุฒ
โ ูููุง ุชุนูู ุนูุฏ ุฅุบูุงู ุงูุชุทุจูู
โ ูููุง ุชุณุชุฎุฏู high_importance_channel
โ Cloud Functions deployed
โ FCM Token ููุญูุธ ุชููุงุฆูุงู
```

---

**ุงููุธุงู ุงูุขู ูุงูู ููุชูุงูู!** ๐๐

**ุชุงุฑูุฎ ุงูุชุญุฏูุซ:** 2025-10-28  
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุฅูุชุงุฌ
