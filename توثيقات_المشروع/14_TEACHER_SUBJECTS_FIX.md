# ๐ง ุฅุตูุงุญ ุนุฑุถ ููุงุฏ ุงููุนูู

## ๐ **ุงูุชุงุฑูุฎ:** 31 ุฃูุชูุจุฑ 2025

---

## โ **ุงููุดููุฉ:**

```
ูู ุญุณุงุจ ุงููุนูู:
- ุชุธูุฑ ุฑุณุงูุฉ "ูุง ุชูุฌุฏ ููุงุฏ ูุฎุตุตุฉ ุจุนุฏ"
- ุงูููุงุฏ ุงููุญุฏุฏุฉ ุนูุฏ ุฅูุดุงุก ุงูุญุณุงุจ ูุง ุชุธูุฑ
```

---

## ๐ **ุงูุณุจุจ:**

### **ุงูููุฏ ุงููุฏูู:**
```dart
// ูุงู ูุญูู ุงูููุงุฏ ูู EducationConstants (ููุฏ ุซุงุจุช)
void _loadTeacherSubjects() {
  final stage = _teacherData!['stage'];
  final grade = _teacherData!['grade'];
  final branch = _teacherData!['branch'];

  _teacherSubjects = EducationConstants.getSubjects(
    stage: stage,
    grade: grade,
    branch: branch,
  );
}
```

### **ุงููุดููุฉ:**
```
โ ูุญูู ูู EducationConstants (ุฌููุน ุงูููุงุฏ)
โ ูุง ูุญูู ูู teachers collection
โ ูุชุฌุงูู ุงูููุงุฏ ุงููุฎุตุตุฉ ูููุนูู
```

---

## โ **ุงูุญู:**

### **ุงูููุฏ ุงูุฌุฏูุฏ:**
```dart
Future<void> _loadTeacherSubjects() async {
  try {
    final user = FirebaseAuth.instance.currentUser;
    
    // 1. ุชุญููู ุงูููุงุฏ ุงููุฎุตุตุฉ ูู teachers collection
    final teacherDoc = await FirebaseFirestore.instance
        .collection('teachers')
        .doc(user.uid)
        .get();

    if (teacherDoc.exists) {
      final data = teacherDoc.data();
      final subjects = data?['subjects'] as List<dynamic>?;

      if (subjects != null && subjects.isNotEmpty) {
        // 2. ุชุญููู ุชูุงุตูู ูู ูุงุฏุฉ ูู subjects collection
        final subjectsList = <Map<String, String>>[];
        
        for (var subjectId in subjects) {
          final subjectDoc = await FirebaseFirestore.instance
              .collection('subjects')
              .doc(subjectId.toString())
              .get();
          
          if (subjectDoc.exists) {
            final subjectData = subjectDoc.data();
            subjectsList.add({
              'name': subjectData?['name'] ?? '',
              'code': subjectDoc.id,
              'emoji': subjectData?['emoji'] ?? '๐',
            });
          }
        }

        setState(() {
          _teacherSubjects = subjectsList;
        });
        return;
      }
    }

    // 3. ุฅุฐุง ูู ุชูุฌุฏ ููุงุฏ ูุฎุตุตุฉุ ุงุณุชุฎุฏู ุงูุงูุชุฑุงุถูุฉ
    _teacherSubjects = EducationConstants.getSubjects(...);
  } catch (e) {
    print('ุฎุทุฃ ูู ุชุญููู ุงูููุงุฏ: $e');
  }
}
```

---

## ๐ **ุงูุชุฏูู ุงูุฌุฏูุฏ:**

### **1. ุชุญููู ุจูุงูุงุช ุงููุนูู:**
```
1. ุงูุจุญุซ ูู teachers collection ุฃููุงู
2. ุฅุฐุง ูู ููุฌุฏุ ุงูุจุญุซ ูู users collection
3. ุญูุธ ุงูุจูุงูุงุช ูู _teacherData
```

### **2. ุชุญููู ุงูููุงุฏ:**
```
1. ุฌูุจ document ุงููุนูู ูู teachers collection
2. ูุฑุงุกุฉ ุญูู subjects (ูุงุฆูุฉ IDs)
3. ููู ID:
   - ุฌูุจ ุชูุงุตูู ุงููุงุฏุฉ ูู subjects collection
   - ุฅุถุงูุฉ: name, code, emoji
4. ุนุฑุถ ุงูููุงุฏ ูู ุงููุงุฌูุฉ
```

### **3. ุงูุงุญุชูุงุทู (Fallback):**
```
ุฅุฐุง ูู ุชูุฌุฏ ููุงุฏ ูุฎุตุตุฉ:
โ ุงุณุชุฎุฏุงู EducationConstants
โ ุนุฑุถ ุฌููุน ููุงุฏ ุงููุฑุญูุฉ ูุงูุตู
```

---

## ๐ **ูููู ุงูุจูุงูุงุช:**

### **teachers collection:**
```javascript
{
  uid: "abc123",
  name: "ุฃุญูุฏ ูุญูุฏ",
  email: "ahmed@codeira.com",
  stage: "ูุชูุณุทุฉ",
  grade: "ุงูุซุงูู ูุชูุณุท",
  branch: null,
  sections: ["ุฃ", "ุจ"],
  subjects: [
    "subject_id_1",  // ุงูุฅุณูุงููุฉ
    "subject_id_2",  // ุงูุนุฑุจูุฉ
    "subject_id_3"   // ุงูุฅููููุฒูุฉ
  ],
  createdAt: Timestamp
}
```

### **subjects collection:**
```javascript
{
  id: "subject_id_1",
  name: "ุงูุฅุณูุงููุฉ",
  emoji: "๐",
  stage: "ูุชูุณุทุฉ",
  grade: "ุงูุซุงูู ูุชูุณุท",
  branch: null
}
```

---

## ๐จ **ุงููุงุฌูุฉ ุจุนุฏ ุงูุฅุตูุงุญ:**

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ููุงุฏ ุงููุนูู                    โ
โ                                  โ
โ  ๐ ุงูุฅุณูุงููุฉ                   โ
โ  ๐ ุงูุนุฑุจูุฉ                     โ
โ  ๐ค ุงูุฅููููุฒูุฉ                  โ
โ                                  โ
โ  (ุงูููุงุฏ ุงููุฎุตุตุฉ ููุท)           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## โ **ุงููุฒุงูุง:**

```
โ ุนุฑุถ ุงูููุงุฏ ุงููุฎุตุตุฉ ูููุนูู ููุท
โ ุชุญููู ูู Firestore (ุฏููุงูููู)
โ ุฏุนู ุงูู Fallback (ุงุญุชูุงุทู)
โ ุนุฑุถ ุงูู emoji ููู ูุงุฏุฉ
โ ุฃุฏุงุก ุฃูุถู (ุชุญููู ูุฑุฉ ูุงุญุฏุฉ)
```

---

## ๐งช **ุงูุงุฎุชุจุงุฑ:**

### **1. ุงุฎุชุจุฑ ุนุฑุถ ุงูููุงุฏ:**
```
1. ุณุฌู ุฏุฎูู ููุนูู
2. โ ูุฌุจ ุฃู ุชุธูุฑ ุงูููุงุฏ ุงููุฎุตุตุฉ
3. โ ูุง ุชุธูุฑ ุฑุณุงูุฉ "ูุง ุชูุฌุฏ ููุงุฏ"
```

### **2. ุงุฎุชุจุฑ ุฅูุดุงุก ูุนูู ุฌุฏูุฏ:**
```
1. ุฃูุดุฆ ุญุณุงุจ ูุนูู
2. ุญุฏุฏ ุงูููุงุฏ: ุงูุฅุณูุงููุฉุ ุงูุนุฑุจูุฉ
3. ุณุฌู ุฏุฎูู ุจุญุณุงุจ ุงููุนูู
4. โ ูุฌุจ ุฃู ุชุธูุฑ ุงููุงุฏุชุงู ููุท
```

### **3. ุงุฎุชุจุฑ Firestore:**
```
Firebase Console โ Firestore

1. ุงูุชุญ teachers collection
2. ุงูุชุญ document ุงููุนูู
3. โ ุชุญูู ูู ูุฌูุฏ ุญูู subjects
4. โ ุชุญูู ูู ูุฌูุฏ IDs ุงูููุงุฏ

5. ุงูุชุญ subjects collection
6. โ ุชุญูู ูู ูุฌูุฏ documents ุงูููุงุฏ
```

---

## ๐ **ุงููููุงุช ุงููุนุฏูุฉ:**

```
โ lib/ui/teacher/teacher_home_complete.dart
   - ุชุญููู ูู teachers collection
   - ุชุญููู ุชูุงุตูู ุงูููุงุฏ ูู subjects
   - ุฏุนู Fallback

โ ุชูุซููุงุช_ุงููุดุฑูุน/14_TEACHER_SUBJECTS_FIX.md
   - ุชูุซูู ุดุงูู ููุฅุตูุงุญ
```

---

## ๐ **ูุซุงู ุนููู:**

### **ุงููุนูู: ุฃุญูุฏ ูุญูุฏ**
```
ุงูููุงุฏ ุงููุฎุตุตุฉ:
- ุงูุฅุณูุงููุฉ
- ุงูุนุฑุจูุฉ
- ุงูุฅููููุฒูุฉ

ุนูุฏ ุชุณุฌูู ุงูุฏุฎูู:
โ ุชุธูุฑ 3 ููุงุฏ ููุท
โ ูุง ุชุธูุฑ ุจุงูู ุงูููุงุฏ
```

### **ุงููุนูู: ูุงุทูุฉ ุนูู**
```
ุงูููุงุฏ ุงููุฎุตุตุฉ:
- ุงูุฑูุงุถูุงุช
- ุงูููุฒูุงุก

ุนูุฏ ุชุณุฌูู ุงูุฏุฎูู:
โ ุชุธูุฑ ูุงุฏุชุงู ููุท
โ ูุง ุชุธูุฑ ุจุงูู ุงูููุงุฏ
```

---

## โ๏ธ **ููุงุญุธุงุช:**

### **ุงูุฃุฏุงุก:**
```
- ุชุญููู ุงูููุงุฏ ูุฑุฉ ูุงุญุฏุฉ ุนูุฏ ูุชุญ ุงูุตูุญุฉ
- ูุง ูุชู ุฅุนุงุฏุฉ ุงูุชุญููู ุฅูุง ุนูุฏ ุฅุนุงุฏุฉ ูุชุญ ุงูุชุทุจูู
- ุงุณุชุฎุฏุงู async/await ููุชุญููู
```

### **ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก:**
```
- try/catch ููุชุนุงูู ูุน ุงูุฃุฎุทุงุก
- ุฑุณุงุฆู console.log ููุชุชุจุน
- Fallback ุฅูู EducationConstants
```

---

**ุงูุญุงูุฉ:** โ ุชู ุงูุฅุตูุงุญ  
**ุฌุงูุฒ ููุงุฎุชุจุงุฑ:** ูุนู  
**ุงูุชุญุณููุงุช:** ุชุญููู ุฏููุงูููู ูู Firestore
