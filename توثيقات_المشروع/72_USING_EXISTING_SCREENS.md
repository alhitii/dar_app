# โ ุงุณุชุฎุฏุงู ุงูุตูุญุงุช ุงูููุฌูุฏุฉ

## ๐ **ุงูุชุงุฑูุฎ:** 1 ููููุจุฑ 2025

---

## ๐ฏ **ุงูุญู ุงูุตุญูุญ:**

ุจุฏูุงู ูู ุฅูุดุงุก ุตูุญุงุช ุฌุฏูุฏุฉุ ูุณุชุฎุฏู ุงูุตูุญุงุช ุงูููุฌูุฏุฉ:

### **1๏ธโฃ ุตูุญุฉ ุงูุชูุจููุงุช (inbox_screen.dart):**
```
โ ุชุนุฑุถ ุฅุดุนุงุฑุงุช ุงูุฅุฏุงุฑุฉ (notifications)
โ ุชุนุฑุถ ุฅุดุนุงุฑุงุช ุงูุบูุงุจ (notifications_absences) ููุฏุฉ ุณูุฉ
โ ูุฏูุฌุฉ ูู ุตูุญุฉ ูุงุญุฏุฉ ูุฑุชุจุฉ ุญุณุจ ุงูุชุงุฑูุฎ
```

### **2๏ธโฃ ุชุจููุจ ุงููุงุฌุจุงุช ุงูุณุงุจูุฉ:**
```
โ ููุฌูุฏ ูู ุงูุชุทุจูู
โ ูุนุฑุถ ุฌููุน ุงููุงุฌุจุงุช ููุฏุฉ ุณูุฉ
```

---

## ๐ **ูุง ุชู ุชุญุฏูุซู:**

### **inbox_screen.dart:**

```dart
// ุฏุงูุฉ ุฌุฏูุฏุฉ ูุชุญููู ุฌููุน ุงูุฅุดุนุงุฑุงุช
Future<List<Map<String, dynamic>>> _loadAllNotifications(String? uid, DateTime now) async {
  final List<Map<String, dynamic>> allNotifications = [];
  
  // 1. ุฅุดุนุงุฑุงุช ุงูุฅุฏุงุฑุฉ (notifications)
  final adminNotifications = await FirebaseFirestore.instance
      .collection('notifications')
      .where('recipientId', isEqualTo: uid)
      .orderBy('createdAt', descending: true)
      .get();
  
  for (var doc in adminNotifications.docs) {
    allNotifications.add({
      ...doc.data(),
      'source': 'admin',
    });
  }
  
  // 2. ุฅุดุนุงุฑุงุช ุงูุบูุงุจ (ููุฏุฉ ุณูุฉ)
  final absenceNotifications = await FirebaseFirestore.instance
      .collection('notifications_absences')
      .where('studentUid', isEqualTo: uid)
      .where('archiveUntil', isGreaterThan: Timestamp.fromDate(now))
      .orderBy('archiveUntil', descending: true)
      .orderBy('createdAt', descending: true)
      .get();
  
  for (var doc in absenceNotifications.docs) {
    final data = doc.data();
    allNotifications.add({
      'title': 'ุฅุดุนุงุฑ ุบูุงุจ',
      'body': data['message'],
      'type': 'absence',
      'createdAt': data['createdAt'],
      'source': 'absence',
    });
  }
  
  // ุชุฑุชูุจ ุญุณุจ ุงูุชุงุฑูุฎ
  allNotifications.sort((a, b) {
    final aTime = (a['createdAt'] as Timestamp?)?.toDate();
    final bTime = (b['createdAt'] as Timestamp?)?.toDate();
    return bTime.compareTo(aTime);
  });
  
  return allNotifications;
}
```

---

## ๐ฑ **ุงููุชูุฌุฉ:**

### **ุตูุญุฉ ุงูุชูุจููุงุช:**
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ุงูุชูุจููุงุช                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โ๏ธ ุฅุดุนุงุฑ ุบูุงุจ                      โ
โ ุบุงุจ ุงูุทุงูุจ ููู ุงูุฃุญุฏ...            โ
โ ููุฐ ุณุงุนุชูู                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ๐ข ุฅุดุนุงุฑ ูู ุงูุฅุฏุงุฑุฉ                โ
โ ุงุฌุชูุงุน ุฃูููุงุก ุงูุฃููุฑ ุบุฏุงู...       โ
โ ููุฐ 3 ุณุงุนุงุช                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โ๏ธ ุฅุดุนุงุฑ ุบูุงุจ                      โ
โ ุบุงุจ ุงูุทุงูุจ ููู ุงูุณุจุช...            โ
โ ููุฐ ููููู                           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## โฐ **ุงููุฏุฉ:**

| ุงูููุน | ุงููุฏุฉ |
|-------|-------|
| ุฅุดุนุงุฑุงุช ุงูุฅุฏุงุฑุฉ | ุฏุงุฆูุฉ |
| ุฅุดุนุงุฑุงุช ุงูุบูุงุจ | ุณูุฉ |

---

## ๐ **ุงููููุงุช ุงููุนุฏูุฉ:**

```
โ lib/ui/student/inbox_screen.dart
   - ุชุญููู ุฅูู StatefulWidget
   - ุฅุถุงูุฉ _loadAllNotifications()
   - ุฏูุฌ ุฅุดุนุงุฑุงุช ุงูุฅุฏุงุฑุฉ ูุงูุบูุงุจ
   - ุชุฑุชูุจ ุญุณุจ ุงูุชุงุฑูุฎ

โ lib/ui/student/all_notifications_screen.dart (ูุญุฐูู)
โ lib/ui/student/previous_homeworks_screen.dart (ูุญุฐูู)
```

---

## ๐งช **ููุงุฎุชุจุงุฑ:**

### **ูู Admin:**
```
1. ุฃุฑุณู ุฅุดุนุงุฑ ุบูุงุจ ูุทุงูุจ
2. ุฃุฑุณู ุฅุดุนุงุฑ ูู ุงูุฅุฏุงุฑุฉ (ุฅู ูุฌุฏ)
```

### **ูู ุทุงูุจ:**
```
1. ุงูุชุญ ุตูุญุฉ "ุงูุชูุจููุงุช"
2. ูุฌุจ ุฃู ุชุฑู:
   - ุฅุดุนุงุฑุงุช ุงูุบูุงุจ (ุณูุฉ)
   - ุฅุดุนุงุฑุงุช ุงูุฅุฏุงุฑุฉ
   - ูุฑุชุจุฉ ุญุณุจ ุงูุชุงุฑูุฎ
```

---

## ๐ฏ **ุงูุฎูุงุตุฉ:**

```
โ ุงุณุชุฎุฏุงู ุงูุตูุญุงุช ุงูููุฌูุฏุฉ
โ ูุง ุฏุงุนู ูุฅูุดุงุก ุตูุญุงุช ุฌุฏูุฏุฉ
โ ูู ุดูุก ูุฏูุฌ ูู inbox_screen.dart
โ ุชุจููุจ ุงููุงุฌุจุงุช ุงูุณุงุจูุฉ ููุฌูุฏ ูุณุจูุงู
```

---

**ุงูุญุงูุฉ:** โ ุชู ุงูุชุญุฏูุซ
