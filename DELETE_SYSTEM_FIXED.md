# ๐๏ธ ุฅุตูุงุญ ูุธุงู ุญุฐู ุงูุญุณุงุจุงุช - ููุชูู ุจุงููุงูู

## โ **ุชู ุฅุตูุงุญ ุงููุดููุฉ ุจุงููุงูู**

---

## ๐จ **ุงููุดููุฉ ุงูุชู ูุงูุช ููุฌูุฏุฉ:**
- **ุนุฑุถ ุฑุณุงูุฉ "ุชู ุงูุญุฐู"** ููู ุงูุญุณุงุจ ูุจูู ููุฌูุฏุงู ูุนููุงู
- **ุนุฏู ุงูุญุฐู ูู Firebase** - ุงูุญุฐู ูุงู ููููุงู ููุท
- **ุนุฏู ุชุญุฏูุซ ุงูููุงุฆู** ุจุนุฏ ุงูุญุฐู
- **ุจูุงูุงุช ุซุงุจุชุฉ** ูู ููุงุฆู ุงูุทูุงุจ ูุงููุนูููู

---

## ๐ง **ุงูุญููู ุงููุทุจูุฉ:**

### **1. ุฅุตูุงุญ ุฏุงูุฉ ุงูุญุฐู:**

#### **ูุจู ุงูุฅุตูุงุญ:**
```dart
onPressed: () {
  Navigator.pop(context);
  ScaffoldMessenger.of(context).showSnackBar(
    SnackBar(
      content: Text('ุชู ุญุฐู $type "$name" ุจูุฌุงุญ'),
      backgroundColor: Colors.red,
    ),
  );
},
```

#### **ุจุนุฏ ุงูุฅุตูุงุญ:**
```dart
onPressed: () async {
  Navigator.pop(context);
  
  // ุฅุธูุงุฑ ูุคุดุฑ ุงูุชุญููู
  showDialog(
    context: context,
    barrierDismissible: false,
    builder: (context) => const Center(
      child: CircularProgressIndicator(),
    ),
  );

  try {
    Map<String, dynamic> result;
    
    if (type == 'ุทุงูุจ' && userData != null) {
      result = await FirebaseUserService().deactivateStudent(
        userData['id'] ?? DateTime.now().millisecondsSinceEpoch.toString(),
        userData['email'] ?? '',
      );
    } else if (type == 'ูุนูู' && userData != null) {
      result = await FirebaseUserService().deactivateTeacher(
        userData['id'] ?? DateTime.now().millisecondsSinceEpoch.toString(),
        userData['email'] ?? '',
      );
    }

    // ูุนุงูุฌุฉ ุงููุชูุฌุฉ ูุนุฑุถ ุงูุฑุณุงุฆู ุงูููุงุณุจุฉ
  } catch (e) {
    // ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
  }
},
```

### **2. ุชุญุฏูุซ ุงุณุชุฏุนุงุกุงุช ุฏุงูุฉ ุงูุญุฐู:**

#### **ุชูุฑูุฑ ุจูุงูุงุช ุงููุณุชุฎุฏู:**
```dart
// ููุทูุงุจ
_showDeleteConfirmDialog(context, student['name']!, 'ุทุงูุจ', student);

// ูููุนูููู  
_showDeleteConfirmDialog(context, teacher['name']!, 'ูุนูู', teacher);
```

### **3. ุฅูุดุงุก ููุงุฆู ุฏููุงููููุฉ ูู Firebase:**

#### **๐ `lib/ui/admin/dynamic_users_list.dart`**
ููุงุฆู ุฌุฏูุฏุฉ ุชุฌูุจ ุงูุจูุงูุงุช ูุจุงุดุฑุฉ ูู Firebase:

##### **ูููุฒุงุช ุงูููุงุฆู ุงูุฌุฏูุฏุฉ:**
- โ **ุฌูุจ ุงูุจูุงูุงุช ุงูุญููููุฉ** ูู Firebase
- โ **ุฅุนุงุฏุฉ ุชุญููู ุชููุงุฆูุฉ** ุจุนุฏ ุงูุญุฐู
- โ **ูุนุงูุฌุฉ ุญุงูุงุช ุงูุชุญููู** ูุงูุฃุฎุทุงุก
- โ **ูุงุฌูุฉ ูุณุชุฎุฏู ูุญุณูุฉ** ูุน ูุคุดุฑุงุช ุงูุญุงูุฉ
- โ **ุญุฐู ูุนูู** ูุน ุชุฃููุฏ ุงููุณุชุฎุฏู

##### **DynamicStudentsList:**
```dart
class DynamicStudentsList extends StatefulWidget {
  // ุฌูุจ ุงูุทูุงุจ ูู Firebase
  final students = await FirebaseUserService().getStudents();
  
  // ุญุฐู ุทุงูุจ ูุน ุชุฃููุฏ
  Future<void> _deleteStudent(Map<String, dynamic> student) async {
    final result = await FirebaseUserService().deactivateStudent(
      student['studentId'] ?? student['id'],
      student['email'],
    );
    
    if (result['success']) {
      // ุฅุนุงุฏุฉ ุชุญููู ุงููุงุฆูุฉ
      _loadStudents();
    }
  }
}
```

##### **DynamicTeachersList:**
```dart
class DynamicTeachersList extends StatefulWidget {
  // ุฌูุจ ุงููุนูููู ูู Firebase
  final teachers = await FirebaseUserService().getTeachers();
  
  // ุญุฐู ูุนูู ูุน ุชุฃููุฏ
  Future<void> _deleteTeacher(Map<String, dynamic> teacher) async {
    final result = await FirebaseUserService().deactivateTeacher(
      teacher['teacherId'] ?? teacher['id'],
      teacher['email'],
    );
    
    if (result['success']) {
      // ุฅุนุงุฏุฉ ุชุญููู ุงููุงุฆูุฉ
      _loadTeachers();
    }
  }
}
```

---

## ๐ **ุขููุฉ ุงูุญุฐู ุงูุฌุฏูุฏุฉ:**

### **๐ ุฎุทูุงุช ุงูุญุฐู:**
1. **ุงููุณุชุฎุฏู ูุถุบุท "ุญุฐู"** ูู ุงููุงุฆูุฉ ุงูููุณุฏูุฉ
2. **ุนุฑุถ ุญูุงุฑ ุงูุชุฃููุฏ** ูุน ุชูุงุตูู ูุงุถุญุฉ
3. **ุฅุธูุงุฑ ูุคุดุฑ ุงูุชุญููู** ุฃุซูุงุก ุงูุนูููุฉ
4. **ุงูุญุฐู ุงููุนูู ูู Firebase** (ุฅูุบุงุก ุชูุนูู)
5. **ุนุฑุถ ุฑุณุงูุฉ ุงููุฌุงุญ/ุงููุดู** ุญุณุจ ุงููุชูุฌุฉ
6. **ุฅุนุงุฏุฉ ุชุญููู ุงููุงุฆูุฉ** ุชููุงุฆูุงู

### **๐ก๏ธ ุงูุฃูุงู ูุงูุชุญูู:**
```dart
// ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช
if (type == 'ุทุงูุจ' && userData != null) {
  result = await FirebaseUserService().deactivateStudent(
    userData['id'] ?? DateTime.now().millisecondsSinceEpoch.toString(),
    userData['email'] ?? '',
  );
} else {
  result = {'success': false, 'message': 'ุจูุงูุงุช ุบูุฑ ุตุญูุญุฉ'};
}
```

---

## ๐๏ธ **ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช:**

### **๐ ุฅูุบุงุก ุงูุชูุนูู ุจุฏูุงู ูู ุงูุญุฐู:**
```dart
// ูู ูุฌููุนุฉ students/teachers
await _firestore.collection('students').doc(studentId).update({
  'isActive': false,
  'deactivatedAt': FieldValue.serverTimestamp(),
  'deactivatedBy': _auth.currentUser?.uid ?? 'admin',
});

// ูู ูุฌููุนุฉ users_emails
await _firestore.collection('users_emails').doc(email).update({
  'isActive': false,
  'deactivatedAt': FieldValue.serverTimestamp(),
});
```

### **๐ ููุชุฑุฉ ุงูุงุณุชุนูุงูุงุช:**
```dart
// ุฌูุจ ุงูุญุณุงุจุงุช ุงููุดุทุฉ ููุท
Query query = _firestore.collection('students');
query = query.where('isActive', isEqualTo: true);
```

---

## ๐จ **ุชุญุณููุงุช ูุงุฌูุฉ ุงููุณุชุฎุฏู:**

### **๐ฑ ุญุงูุงุช ุงูุชุญููู:**
- โ **ูุคุดุฑ ุชุญููู** ุฃุซูุงุก ุฌูุจ ุงูุจูุงูุงุช
- โ **ุฑุณุงูุฉ ุฎุทุฃ** ูุน ุฒุฑ ุฅุนุงุฏุฉ ุงููุญุงููุฉ
- โ **ุฑุณุงูุฉ ูุงุฑุบุฉ** ุนูุฏ ุนุฏู ูุฌูุฏ ุจูุงูุงุช
- โ **ุฒุฑ ุฅุนุงุฏุฉ ุงูุชุญููู** ูู ุฃุนูู ุงููุงุฆูุฉ

### **๐ ุงูุชูุงุนู ุงููุญุณู:**
```dart
// ุญูุงุฑ ุชุฃููุฏ ูุงุถุญ
AlertDialog(
  title: Text('ุชุฃููุฏ ุงูุญุฐู'),
  content: Text(
    'ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู $type "$name"ุ\n'
    'ุณูุชู ุฅูุบุงุก ุชูุนูู ุงูุญุณุงุจ ูุฅุฎูุงุคู ูู ุงูููุงุฆู.',
  ),
  actions: [
    TextButton(child: Text('ุฅูุบุงุก')),
    ElevatedButton(
      style: ElevatedButton.styleFrom(backgroundColor: Colors.red),
      child: Text('ุญุฐู'),
    ),
  ],
)
```

---

## ๐ **ุงูููุงุฆุฏ ุงููุญููุฉ:**

### **๐ฏ ุญุฐู ูุนูู:**
- **ุญุฐู ุญูููู** ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- **ุนุฏู ุธููุฑ ุงูุญุณุงุจุงุช ุงููุญุฐููุฉ** ูู ุงูููุงุฆู
- **ููุน ุชุณุฌูู ุงูุฏุฎูู** ููุญุณุงุจุงุช ุงููุญุฐููุฉ

### **๐ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ูุญุณูุฉ:**
- **ุฑุฏูุฏ ูุนู ูุงุถุญุฉ** ูููุณุชุฎุฏู
- **ูุคุดุฑุงุช ุชุญููู** ููุงุณุจุฉ
- **ุฑุณุงุฆู ุฎุทุฃ ูููุฏุฉ** ููููููุฉ
- **ุชุญุฏูุซ ุชููุงุฆู** ููููุงุฆู

### **๐ ุฃูุงู ูุญุณู:**
- **ุชุฃููุฏ ูุถุงุนู** ูุจู ุงูุญุฐู
- **ุชุณุฌูู ุงูุนูููุงุช** ูุน ุงูุทูุงุจุน ุงูุฒูููุฉ
- **ุชุชุจุน ูู ูุงู ุจุงูุญุฐู**

---

## ๐งช **ุงุฎุชุจุงุฑ ุงููุธุงู ุงูุฌุฏูุฏ:**

### **๐ ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ:**

#### **1. ุงุฎุชุจุงุฑ ุญุฐู ุทุงูุจ:**
```
1. ุงูุชุญ ุชุจููุจ "ุงูุทูุงุจ"
2. ุงูุชุธุฑ ุชุญููู ุงููุงุฆูุฉ ูู Firebase
3. ุงุถุบุท ุนูู ุงููุงุฆูุฉ ุงูููุณุฏูุฉ ูุฃู ุทุงูุจ
4. ุงุฎุชุฑ "ุญุฐู"
5. ุฃูุฏ ุงูุญุฐู ูู ุงูุญูุงุฑ
6. ุงูุชุธุฑ ูุคุดุฑ ุงูุชุญููู
7. ุชุญูู ูู ุฑุณุงูุฉ ุงููุฌุงุญ
8. ุชุฃูุฏ ูู ุงุฎุชูุงุก ุงูุทุงูุจ ูู ุงููุงุฆูุฉ
9. ุฌุฑุจ ุชุณุฌูู ุฏุฎูู ุงูุทุงูุจ ุงููุญุฐูู (ูุฌุจ ุฃู ููุดู)
```

#### **2. ุงุฎุชุจุงุฑ ุญุฐู ูุนูู:**
```
1. ุงูุชุญ ุชุจููุจ "ุงููุนูููู"
2. ูุฑุฑ ููุณ ุฎุทูุงุช ุงุฎุชุจุงุฑ ุงูุทุงูุจ
3. ุชุฃูุฏ ูู ุงูุญุฐู ุงููุนูู
```

#### **3. ุงุฎุชุจุงุฑ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก:**
```
1. ุงูุทุน ุงูุฅูุชุฑูุช
2. ุฌุฑุจ ุญุฐู ุญุณุงุจ
3. ุชุญูู ูู ุฑุณุงูุฉ ุงูุฎุทุฃ ุงูููุงุณุจุฉ
4. ุฃุนุฏ ุงูุฅูุชุฑูุช ูุฌุฑุจ ูุฑุฉ ุฃุฎุฑู
```

---

## โ **ุงููููุงุช ุงููุญุฏุซุฉ:**

### **๐ ุงููููุงุช ุงูุฌุฏูุฏุฉ:**
1. โ `lib/ui/admin/dynamic_users_list.dart` - ููุงุฆู ุฏููุงููููุฉ ูู Firebase

### **๐ ุงููููุงุช ุงููุญุฏุซุฉ:**
1. โ `lib/ui/admin/admin_tabs_screen.dart` - ุฅุตูุงุญ ุฏุงูุฉ ุงูุญุฐู ูุงุณุชุฎุฏุงู ุงูููุงุฆู ุงูุฌุฏูุฏุฉ
2. โ `lib/services/firebase_user_service.dart` - ุฏูุงู ุงูุญุฐู ููุฌูุฏุฉ ูุณุจูุงู

---

## ๐ **ุงููุชูุฌุฉ ุงูููุงุฆูุฉ:**

**โ ูุธุงู ุญุฐู ูุญุณู ููุนุงู:**
- **ุญุฐู ูุนูู** ูู Firebase
- **ุชุญุฏูุซ ุชููุงุฆู** ููููุงุฆู
- **ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก**
- **ูุงุฌูุฉ ูุณุชุฎุฏู ูุญุณูุฉ**
- **ุฃูุงู ูุชุฃููุฏ ูุถุงุนู**

**๐๏ธ ุงููุดููุฉ ูุญูููุฉ ุจุงููุงูู! ุงูุญุฐู ูุนูู ูุนููุงู ุงูุขู! โจ**
